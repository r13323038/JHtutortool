# ğŸ“ GitHub âœ Cloud Run è‡ªå‹•éƒ¨ç½²æµç¨‹ç­†è¨˜

é€™æ˜¯ä¸€ä»½æ•´ç†å¥½çš„éƒ¨ç½²ç­†è¨˜ï¼Œå¹«åŠ©æˆ‘è¨˜éŒ„å¦‚ä½•ä½¿ç”¨ Git + GitHub + Cloud Run è‡ªå‹•éƒ¨ç½² LINE Bot å°ˆæ¡ˆã€‚

---

## ğŸ“¦ å°ˆæ¡ˆæ¶æ§‹

```
JHtutortool/
â”œâ”€â”€ main.py
â”œâ”€â”€ line_bot.py
â”œâ”€â”€ search_knowledge.py
â”œâ”€â”€ prompt_engine.py
â”œâ”€â”€ chatgpt_api.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ cloudbuild.yaml âœ…
â”œâ”€â”€ .gitignore âœ…
â””â”€â”€ .env âŒï¼ˆä¸æ‡‰åŠ å…¥ Gitï¼‰
```

---

## ğŸ” æ—¥å¸¸éƒ¨ç½²æµç¨‹ï¼ˆé–‹ç™¼ âœ ä¸Šç·šï¼‰

```bash
# 1ï¸âƒ£ é€²å…¥å°ˆæ¡ˆè³‡æ–™å¤¾
cd ~/JHtutortool

# 2ï¸âƒ£ æŸ¥çœ‹ç›®å‰æª”æ¡ˆç‹€æ…‹ï¼ˆéå¿…é ˆï¼‰
git status

# 3ï¸âƒ£ åŠ å…¥æ‰€æœ‰è®Šæ›´
git add .

# 4ï¸âƒ£ å»ºç«‹ commitï¼ˆæè¿°é€™æ¬¡ä¿®æ”¹ï¼‰
git commit -m "æè¿°é€™æ¬¡ä¿®æ”¹ï¼Œä¾‹å¦‚ï¼šæ–°å¢ ping è·¯ç”±"

# 5ï¸âƒ£ æ¨é€åˆ° GitHubï¼Œè§¸ç™¼éƒ¨ç½²
git push
```

âœ”ï¸ å®Œæˆå¾Œ Cloud Build Trigger å°‡æœƒï¼š

* åµæ¸¬ push
* ä½¿ç”¨ cloudbuild.yaml build & deploy
* è‡ªå‹•æ›´æ–° Cloud Run ä¸Šç·šç‰ˆæœ¬

---

## âš™ï¸ cloudbuild.yaml æ¨£æ¿

```yaml
steps:
  - name: 'gcr.io/cloud-builders/docker'
    args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/line-bot-app', '.' ]

  - name: 'gcr.io/cloud-builders/docker'
    args: [ 'push', 'gcr.io/$PROJECT_ID/line-bot-app' ]

  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: 'gcloud'
    args:
      [
        'run',
        'deploy',
        'line-bot-app',
        '--image',
        'gcr.io/$PROJECT_ID/line-bot-app',
        '--region',
        'asia-east1',
        '--platform',
        'managed',
        '--allow-unauthenticated',
        '--set-env-vars',
        'LINE_CHANNEL_ACCESS_TOKEN=$_LINE_CHANNEL_ACCESS_TOKEN,LINE_CHANNEL_SECRET=$_LINE_CHANNEL_SECRET,OPENAI_API_KEY=$_OPENAI_API_KEY'
      ]

options:
  logging: CLOUD_LOGGING_ONLY
```

---

## ğŸ” Substitution Variables è¨­å®šå»ºè­°ï¼ˆTrigger ä¸­è¨­å®šï¼‰

```text
_LINE_CHANNEL_ACCESS_TOKEN=xxxxx
_LINE_CHANNEL_SECRET=xxxxx
_OPENAI_API_KEY=sk-xxxxx
```

---

## âœ… å®Œæ•´ä¸€æ¢é¾éƒ¨ç½²æˆåŠŸæ¢ä»¶

| æ¢ä»¶                           | æ˜¯å¦éœ€è¦                |
| :--------------------------- | :------------------ |
| `cloudbuild.yaml`            | âœ… å¿…é ˆï¼Œæœ‰å®Œæ•´æ­¥é©Ÿ          |
| Dockerfile                   | âœ… å¿…é ˆï¼Œæä¾› build åŸºåº•    |
| GitHub Repo é€£çµ Trigger       | âœ… å¿…é ˆ                |
| Git Push åˆ° main branch       | âœ… å¿…é ˆè§¸ç™¼éƒ¨ç½²            |
| è¨­å®šç’°å¢ƒè®Šæ•¸æ–¼ Triggerï¼ˆæˆ– Cloud Runï¼‰ | âœ… å»ºè­°ä½¿ç”¨ Substitution |

---

## ğŸ§  å‚™è¨»

* Cloud Run çš„æ–°ç‰ˆæœƒè¦†è“‹èˆŠç‰ˆï¼Œä½†ä¸æœƒä¿ç•™èˆŠçš„ç’°å¢ƒè®Šæ•¸
* æ‰€æœ‰è®Šæ›´éƒ½æ‡‰ä½¿ç”¨ commit åšèªªæ˜ï¼Œæ–¹ä¾¿æœªä¾†å›æº¯
* `.env` ä¸æ‡‰æ¨ä¸Š Gitï¼ˆè¨˜å¾—åŠ é€² .gitignoreï¼‰

---

ğŸ§  æœ¬æ–‡ä»¶å¯ç•¶ä½œéƒ¨ç½²åƒè€ƒï¼Œæˆ– README ä½¿ç”¨ï¼
